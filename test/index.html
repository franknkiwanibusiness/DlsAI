<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>GROQ STABLE SCANNER TEST</title>
    <style>
        body { background: #050505; color: #00ffff; font-family: monospace; padding: 30px; }
        .test-card { max-width: 500px; margin: auto; border: 1px solid #00ffff44; padding: 20px; border-radius: 10px; background: #0a0a0a; box-shadow: 0 0 20px rgba(0,255,255,0.1); }
        input, button { width: 100%; padding: 12px; margin-top: 10px; border-radius: 5px; border: 1px solid #333; box-sizing: border-box; }
        input { background: #000; color: #fff; }
        button { background: #00ffff; color: #000; font-weight: bold; border: none; cursor: pointer; }
        #log { margin-top: 20px; padding: 15px; background: #000; border: 1px solid #222; min-height: 100px; color: #00ff00; white-space: pre-wrap; font-size: 0.85rem; }
        #preview { width: 100%; margin-top: 15px; display: none; border-radius: 5px; }
    </style>
</head>
<body>

    <div class="test-card">
        <h2 style="text-align: center;">STABLE NEURAL LINK TEST</h2>
        
        <input type="password" id="apiKey" placeholder="GSK KEY HERE">
        <input type="file" id="imageInput" accept="image/*">
        <img id="preview">
        
        <button id="runBtn">SCAN SQUAD</button>

        <div id="log">> STANDBY...</div>
    </div>

    <script>
        let base64 = "";
        const preview = document.getElementById('preview');
        const log = document.getElementById('log');

        document.getElementById('imageInput').onchange = (e) => {
            const reader = new FileReader();
            reader.onload = () => {
                preview.src = reader.result;
                preview.style.display = 'block';
                base64 = reader.result.split(',')[1];
                log.innerText = "> IMAGE LOADED. READY.";
            };
            reader.readAsDataURL(e.target.files[0]);
        };

        document.getElementById('runBtn').onclick = async () => {
            const key = document.getElementById('apiKey').value;
            if(!key || !base64) return alert("Missing Key or Image");

            log.innerText = "> INITIALIZING STABLE ENGINE: llama-4-scout...";
            log.style.color = "#00ffff";

            try {
                const res = await fetch("https://api.groq.com/openai/v1/chat/completions", {
                    method: "POST",
                    headers: { "Authorization": `Bearer ${key}`, "Content-Type": "application/json" },
                    body: JSON.stringify({
                        // UPDATED TO 2026 STABLE VISION MODEL
                        model: "meta-llama/llama-4-scout-17b-16e-instruct",
                        messages: [{
                            role: "user",
                            content: [
                                { type: "text", text: "Analyze this DLS squad. List the players and their ratings clearly." },
                                { type: "image_url", image_url: { url: `data:image/jpeg;base64,${base64}` } }
                            ]
                        }]
                    })
                });

                const data = await res.json();
                
                if(data.error) {
                    log.style.color = "#ff4444";
                    log.innerText = "❌ ERROR: " + data.error.message;
                } else {
                    log.style.color = "#00ff00";
                    log.innerText = "✅ SCAN COMPLETE:\n\n" + data.choices[0].message.content;
                }
            } catch (e) {
                log.innerText = "❌ CRASH: " + e.message;
            }
        };
    </script>
</body>
</html>
