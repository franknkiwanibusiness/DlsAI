<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Odds Tracker</title>
    <style>
        :root {
            --ios-bg: #f2f2f7;
            --ios-card: #ffffff;
            --ios-blue: #007aff;
            --ios-secondary: #8e8e93;
            --ios-border: #c6c6c8;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: -apple-system, system-ui; }
        body { background: var(--ios-bg); padding-bottom: 100px; color: #000; }

        header {
            position: sticky; top: 0; z-index: 100;
            background: rgba(242, 242, 247, 0.85); backdrop-filter: blur(20px);
            padding: 20px 16px 10px; border-bottom: 0.5px solid var(--ios-border);
        }
        h1 { font-size: 28px; font-weight: 700; letter-spacing: -0.5px; }

        .container { padding: 12px; }
        .card {
            background: var(--ios-card); border-radius: 14px; 
            margin-bottom: 12px; padding: 16px;
            box-shadow: 0 1px 2px rgba(0,0,0,0.05);
        }

        .match-info { display: flex; justify-content: space-between; margin-bottom: 12px; font-size: 12px; color: var(--ios-secondary); font-weight: 600; }
        .teams-row { display: grid; grid-template-columns: 1fr 40px 1fr; align-items: center; text-align: center; margin-bottom: 15px; }
        .team-name { font-size: 16px; font-weight: 600; }
        .vs { color: var(--ios-border); font-size: 12px; font-weight: 700; }

        .odds-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; }
        .odd-btn {
            background: #f8f8f8; border: none; border-radius: 8px;
            padding: 10px; text-align: center; cursor: pointer;
        }
        .odd-label { display: block; font-size: 10px; color: var(--ios-secondary); margin-bottom: 2px; }
        .odd-value { font-size: 14px; font-weight: 700; color: var(--ios-blue); }

        .tab-bar {
            position: fixed; bottom: 0; width: 100%; height: 85px;
            background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(15px);
            border-top: 0.5px solid var(--ios-border); display: flex;
        }
        .tab-item { flex: 1; text-align: center; color: var(--ios-secondary); padding-top: 10px; cursor: pointer; }
        .tab-item.active { color: var(--ios-blue); }
        .tab-icon { font-size: 22px; }
        .tab-label { font-size: 10px; margin-top: 2px; }
    </style>
</head>
<body>

<header>
    <h1 id="view-title">Premier League</h1>
</header>

<div class="container" id="main-content">
    <div style="text-align:center; padding:50px; color:#888;">Loading fixtures...</div>
</div>

<nav class="tab-bar">
    <div class="tab-item active" onclick="fetchOdds('soccer_epl', 'Premier League', this)">
        <div class="tab-icon">üè¥Û†ÅßÛ†Å¢Û†Å•Û†ÅÆÛ†ÅßÛ†Åø</div><div class="tab-label">EPL</div>
    </div>
    <div class="tab-item" onclick="fetchOdds('soccer_spain_la_liga', 'La Liga', this)">
        <div class="tab-icon">üá™üá∏</div><div class="tab-label">LaLiga</div>
    </div>
    <div class="tab-item" onclick="fetchOdds('soccer_italy_serie_a', 'Serie A', this)">
        <div class="tab-icon">üáÆüáπ</div><div class="tab-label">Serie A</div>
    </div>
    <div class="tab-item" onclick="fetchOdds('soccer_germany_bundesliga', 'Bundesliga', this)">
        <div class="tab-icon">üá©üá™</div><div class="tab-label">Bundes</div>
    </div>
    <div class="tab-item" onclick="fetchOdds('soccer_france_ligue_one', 'Ligue 1', this)">
        <div class="tab-icon">üá´üá∑</div><div class="tab-label">Ligue 1</div>
    </div>
</nav>

<script>
    const API_KEY = '826ccd6998728ab23f00ac7ad0546c2b';

    async function fetchOdds(sportKey, title, el) {
        document.getElementById('view-title').innerText = title;
        document.getElementById('main-content').innerHTML = '<div style="text-align:center; padding:50px; color:#888;">Updating odds...</div>';
        
        document.querySelectorAll('.tab-item').forEach(t => t.classList.remove('active'));
        if(el) el.classList.add('active');

        try {
            // The Odds API v4 endpoint
            const url = `https://api.the-odds-api.com/v4/sports/${sportKey}/odds/?apiKey=${API_KEY}&regions=uk&markets=h2h&oddsFormat=decimal`;
            const response = await fetch(url);
            const data = await response.json();
            
            if (data.length === 0) {
                document.getElementById('main-content').innerHTML = '<div style="text-align:center; padding:50px; color:#888;">No upcoming matches found.</div>';
                return;
            }
            renderMatches(data);
        } catch (error) {
            document.getElementById('main-content').innerHTML = `<div style="text-align:center; padding:50px; color:red;">Error: ${error.message}</div>`;
        }
    }

    function renderMatches(matches) {
        const container = document.getElementById('main-content');
        container.innerHTML = matches.map(match => {
            const date = new Date(match.commence_time).toLocaleDateString([], { weekday: 'short', month: 'short', day: 'numeric', hour: '2-digit', minute: '2-digit' });
            
            // Extracting H2H odds from the first bookmaker (usually William Hill or Unibet in UK region)
            const bookmaker = match.bookmakers[0];
            const market = bookmaker ? bookmaker.markets[0] : null;
            
            const homeOdd = market ? market.outcomes.find(o => o.name === match.home_team)?.price || '-' : '-';
            const awayOdd = market ? market.outcomes.find(o => o.name === match.away_team)?.price || '-' : '-';
            const drawOdd = market ? market.outcomes.find(o => o.name === 'Draw')?.price || '-' : '-';

            return `
                <div class="card">
                    <div class="match-info">
                        <span>${date}</span>
                        <span>${bookmaker ? bookmaker.title : 'No Odds'}</span>
                    </div>
                    <div class="teams-row">
                        <div class="team-name">${match.home_team}</div>
                        <div class="vs">VS</div>
                        <div class="team-name">${match.away_team}</div>
                    </div>
                    <div class="odds-grid">
                        <div class="odd-btn"><span class="odd-label">Home</span><span class="odd-value">${homeOdd}</span></div>
                        <div class="odd-btn"><span class="odd-label">Draw</span><span class="odd-value">${drawOdd}</span></div>
                        <div class="odd-btn"><span class="odd-label">Away</span><span class="odd-value">${awayOdd}</span></div>
                    </div>
                </div>
            `;
        }).join('');
    }

    // Default load
    fetchOdds('soccer_epl', 'Premier League');
</script>
</body>
</html>
