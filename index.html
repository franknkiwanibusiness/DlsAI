<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hoyoo AI | Quantum Scout</title>
    <style>
        :root { --neon: #00ff88; --bg: #0a0a0a; --card: #141414; }
        body { background: var(--bg); color: white; font-family: 'Inter', sans-serif; padding: 20px; }
        .input-group { display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap; }
        input, select { background: #222; border: 1px solid #444; color: white; padding: 12px; border-radius: 8px; flex: 1; }
        button { background: var(--neon); color: black; border: none; padding: 12px 24px; border-radius: 8px; font-weight: bold; cursor: pointer; }
        button:disabled { opacity: 0.5; cursor: not-allowed; }
        
        #error-display { background: #ff444422; color: #ff4444; border: 1px solid #ff4444; padding: 15px; border-radius: 8px; display: none; margin-bottom: 20px; }
        
        .scout-card { background: var(--card); border: 1px solid #333; padding: 25px; border-radius: 16px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        .badge { background: var(--neon); color: black; padding: 4px 12px; border-radius: 20px; font-size: 12px; font-weight: 900; }
        .grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin: 20px 0; }
        .stat-box { background: #1a1a1a; padding: 10px; border-radius: 8px; text-align: center; border: 1px solid #333; }
    </style>
</head>
<body>

    <div id="error-display"></div>

    <div class="input-group">
        <input type="text" id="home-team" placeholder="Home Team">
        <input type="text" id="away-team" placeholder="Away Team">
        <select id="sport-select">
            <option value="soccer_epl">Premier League</option>
            <option value="soccer_uefa_champs_league">Champions League</option>
            <option value="soccer_spain_la_liga">La Liga</option>
        </select>
        <button id="scout-btn" onclick="runScout()">SCOUT FIXTURE</button>
    </div>

    <div id="output">
        </div>

    <script>
        const API_URL = "https://your-vercel-domain.vercel.app/api/analyze";

        // LOAD FROM LOCAL STORAGE ON REFRESH
        window.onload = () => {
            const saved = localStorage.getItem('hoyoo_latest');
            if (saved) renderUI(JSON.parse(saved));
        };

        async function runScout() {
            const btn = document.getElementById('scout-btn');
            const errBox = document.getElementById('error-display');
            
            btn.disabled = true;
            btn.innerText = "THINKING...";
            errBox.style.display = 'none';

            const query = new URLSearchParams({
                home: document.getElementById('home-team').value,
                away: document.getElementById('away-team').value,
                sport: document.getElementById('sport-select').value
            });

            try {
                const res = await fetch(`${API_URL}?${query}`);
                const data = await res.json();

                if (!res.ok) throw new Error(data.message || "Brain Timeout");

                // SAVE & RENDER
                localStorage.setItem('hoyoo_latest', JSON.stringify(data));
                renderUI(data);

            } catch (err) {
                errBox.innerText = `[CRITICAL ERROR]: ${err.message}`;
                errBox.style.display = 'block';
            } finally {
                btn.disabled = false;
                btn.innerText = "SCOUT FIXTURE";
            }
        }

        function renderUI(d) {
            document.getElementById('output').innerHTML = `
                <div class="scout-card">
                    <div style="display:flex; justify-content:between; align-items:center;">
                        <span class="badge">CONFIDENCE: ${d.confidence_score}%</span>
                        <h2 style="margin: 10px 0;">${d.fixture}</h2>
                    </div>
                    
                    <div class="grid">
                        <div class="stat-box">Home: ${d.probabilities.home}</div>
                        <div class="stat-box">Draw: ${d.probabilities.draw}</div>
                        <div class="stat-box">Away: ${d.probabilities.away}</div>
                    </div>

                    <div style="border-left: 4px solid var(--neon); padding-left: 15px; margin: 20px 0;">
                        <h3 style="color: var(--neon); margin:0;">PICK: ${d.market_analysis.primary_pick}</h3>
                        <small>EXPECTED VALUE: ${d.market_analysis.ev_edge}</small>
                    </div>

                    <p style="color: #aaa; line-height: 1.6;">${d.brain_thoughts}</p>
                    
                    <div style="margin-top: 20px; font-weight: bold;">
                        TOP PROJECTED SCORES: ${d.market_analysis.top_3_scores.join(' | ')}
                    </div>
                </div>
            `;
        }
    </script>
</body>
</html>
