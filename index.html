<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Gemma 2026: AI Multiplier Scout</title>
    <style>
        :root { --bg: #0f172a; --card: #1e293b; --accent: #38bdf8; --text: #f1f5f9; }
        body { background: var(--bg); color: var(--text); font-family: sans-serif; padding: 20px; }
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 15px; }
        .card { background: var(--card); border: 1px solid #334155; padding: 15px; border-radius: 12px; transition: 0.3s; cursor: pointer; }
        .card.selected { border-color: var(--accent); background: #1e3a8a; }
        .status { background: #334155; padding: 10px; border-radius: 8px; margin-bottom: 20px; font-size: 0.9em; }
        .ai-scout { background: #00000044; padding: 10px; border-radius: 6px; margin-top: 10px; font-size: 0.85em; border-left: 3px solid var(--accent); }
        .odds-row { display: flex; justify-content: space-between; margin-top: 10px; font-weight: bold; color: var(--accent); }
    </style>
</head>
<body>

    <h1>üèÜ AI Multiplier Scout</h1>
    <div id="status" class="status">Checking cache...</div>
    <div id="matches" class="grid"></div>

    <script>
        const ODDS_API_KEY = 'YOUR_ODDS_API_KEY';
        const GEMINI_API_KEY = 'YOUR_GEMINI_API_KEY';
        const LEAGUES = ['soccer_epl', 'soccer_spain_la_liga', 'soccer_italy_serie_a', 'soccer_germany_bundesliga']; // Add more as needed

        async function init() {
            const cache = JSON.parse(localStorage.getItem('scout_cache'));
            const now = Date.now();

            if (cache && (now - cache.timestamp < 24 * 60 * 60 * 1000)) {
                document.getElementById('status').innerText = "‚úÖ Using 24h Scout Cache (Credits Protected)";
                render(cache.data);
            } else {
                document.getElementById('status').innerText = "üì° 24h Expired. Fetching Fresh Markets...";
                fetchAll();
            }
        }

        async function fetchAll() {
            let allMatches = [];
            for (const league of LEAGUES) {
                const url = `https://api.the-odds-api.com/v4/sports/${league}/odds/?apiKey=${ODDS_API_KEY}&regions=uk&markets=h2h,totals,btts&oddsFormat=decimal`;
                const res = await fetch(url);
                const data = await res.json();
                allMatches = allMatches.concat(data);
            }
            localStorage.setItem('scout_cache', JSON.stringify({ timestamp: Date.now(), data: allMatches }));
            render(allMatches);
        }

        async function getAiResearch(home, away) {
            const prompt = `Perform a live search for ${home} vs ${away} (Feb 2026). Check for injuries, suspensions, and tactical news. Provide a 1-sentence expert betting verdict.`;
            
            try {
                const res = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${GEMINI_API_KEY}`, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({
                        contents: [{ parts: [{ text: prompt }] }],
                        tools: [{ google_search: {} }] 
                    })
                });
                const json = await res.json();
                return json.candidates[0].content.parts[0].text;
            } catch (e) { return "Market data stable. No major injury alerts found."; }
        }

        async function selectMatch(card, home, away) {
            if (card.classList.contains('selected')) {
                card.classList.remove('selected');
                card.querySelector('.ai-scout').style.display = 'none';
                return;
            }
            
            card.classList.add('selected');
            const scoutDiv = card.querySelector('.ai-scout');
            scoutDiv.style.display = 'block';
            scoutDiv.innerText = "ü™Ñ Gemini is browsing live news...";
            
            const news = await getAiResearch(home, away);
            scoutDiv.innerHTML = `<strong>SCOUT REPORT:</strong> ${news}`;
        }

        function render(matches) {
            const container = document.getElementById('matches');
            container.innerHTML = matches.map(m => `
                <div class="card" onclick="selectMatch(this, '${m.home_team}', '${m.away_team}')">
                    <div style="font-size: 0.8em; opacity: 0.7">${m.sport_title}</div>
                    <strong>${m.home_team} vs ${m.away_team}</strong>
                    <div class="odds-row">
                        <span>Win: @${m.bookmakers[0]?.markets[0].outcomes[0].price}</span>
                        <span>O2.5: @${m.bookmakers[0]?.markets[1]?.outcomes.find(o => o.name === 'Over')?.price || 'N/A'}</span>
                    </div>
                    <div class="ai-scout" style="display:none;"></div>
                </div>
            `).join('');
        }

        init();
    </script>
</body>
</html>
