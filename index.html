<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Multiplier Scout | Easybet 2026</title>
    <style>
        :root { --bg: #0f172a; --card: #1e293b; --accent: #38bdf8; --text: #f1f5f9; }
        body.light { --bg: #f8fafc; --card: #ffffff; --accent: #0284c7; --text: #0f172a; }
        body.blue { --bg: #1e3a8a; --card: #1e40af; --accent: #60a5fa; --text: #eff6ff; }
        body.disco { animation: discoBg 1s infinite; }
        @keyframes discoBg { 
            0% { background: #ff0000; } 25% { background: #00ff00; } 
            50% { background: #0000ff; } 75% { background: #ffff00; } 100% { background: #ff0000; } 
        }

        body { background: var(--bg); color: var(--text); font-family: 'Segoe UI', system-ui, sans-serif; margin: 0; padding: 20px; transition: 0.3s; padding-bottom: 120px; }
        .header { display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #334155; padding-bottom: 15px; }
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 15px; margin-top: 20px; }
        
        .card { background: var(--card); border: 2px solid #334155; padding: 18px; border-radius: 12px; cursor: pointer; transition: transform 0.2s; position: relative; }
        .card:hover { transform: translateY(-3px); }
        .card.selected { border-color: var(--accent); box-shadow: 0 0 20px var(--accent); background: rgba(56, 189, 248, 0.1); }
        
        .market-badge { background: #334155; padding: 4px 8px; border-radius: 6px; font-size: 0.75em; margin-right: 5px; }
        .ai-scout { background: #00000044; padding: 12px; border-radius: 8px; margin-top: 12px; font-size: 0.85em; display: none; border-left: 4px solid #fbbf24; line-height: 1.4; }
        
        .slip { position: fixed; bottom: 0; left: 0; right: 0; background: #111827; padding: 20px; border-top: 4px solid var(--accent); z-index: 100; }
        .payout-text { font-size: 1.4em; font-weight: 800; color: #10b981; }
        .cap-warning { color: #ef4444; font-size: 0.8em; font-weight: bold; margin-top: 4px; }

        #settingsModal { display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: #1e293b; border: 2px solid var(--accent); padding: 30px; border-radius: 20px; z-index: 1001; width: 320px; box-shadow: 0 0 50px rgba(0,0,0,0.8); }
        .overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); z-index: 1000; }
        input, select { width: 100%; padding: 12px; margin: 10px 0; border-radius: 8px; border: 1px solid #334155; background: #0f172a; color: white; }
        .btn { padding: 12px 20px; border: none; border-radius: 8px; cursor: pointer; font-weight: 700; text-transform: uppercase; }
        .btn-accent { background: var(--accent); color: #000; }
    </style>
</head>
<body class="dark">

    <div class="header">
        <div>
            <h1 style="margin:0;">üèÜ AI SCOUT</h1>
            <span id="status" style="font-size: 0.7em; opacity: 0.6;">Initializing...</span>
        </div>
        <button class="btn btn-accent" onclick="toggleSettings()">‚öôÔ∏è Settings</button>
    </div>

    <div id="matches" class="grid"></div>

    <div class="slip">
        <div style="display: flex; justify-content: space-between; align-items: center; max-width: 1200px; margin: 0 auto;">
            <div>
                <span style="opacity: 0.7;">Stake:</span> <strong>R<span id="displayStake">10</span></strong> | 
                <span style="opacity: 0.7;">Total Odds:</span> <strong><span id="totalOdds">1.00</span></strong>
            </div>
            <div style="text-align: right;">
                <div class="payout-text" id="payout">R0.00</div>
                <div id="capWarning" class="cap-warning"></div>
            </div>
        </div>
    </div>

    <div id="overlay" class="overlay" onclick="toggleSettings()"></div>
    <div id="settingsModal">
        <h2 style="margin-top:0;">Settings</h2>
        <label>Visual Theme</label>
        <select id="themeSelect" onchange="applyTheme()">
            <option value="dark">Midnight Dark</option>
            <option value="light">Crisp Light</option>
            <option value="blue">Electric Blue</option>
            <option value="disco">üï∫ Disco Mode</option>
        </select>
        <label>Bet Amount (R)</label>
        <input type="number" id="stakeInput" placeholder="Enter stake..." onchange="updateStake()">
        <p style="font-size: 0.7em; opacity: 0.5;">Settings auto-save to device.</p>
        <button class="btn btn-accent" style="width:100%" onclick="toggleSettings()">Apply & Close</button>
    </div>

    <script>
        // CONFIG - ADD YOUR KEYS HERE
        const ODDS_KEY = 'YOUR_ODDS_API_KEY';
        const GEMINI_KEY = 'YOUR_GEMINI_API_KEY';
        const EASYBET_LIMIT = 2000000;

        let selections = new Map();
        let currentStake = 10;

        async function init() {
            // Load Settings
            currentStake = localStorage.getItem('scout_stake') || 10;
            document.getElementById('stakeInput').value = currentStake;
            document.getElementById('displayStake').innerText = currentStake;
            applyTheme(localStorage.getItem('scout_theme') || 'dark');

            // Check Cache
            const cache = JSON.parse(localStorage.getItem('scout_cache_v4'));
            if (cache && (Date.now() - cache.ts < 24 * 60 * 60 * 1000)) {
                document.getElementById('status').innerText = "Using Safe 24h Cache";
                render(cache.data);
            } else {
                fetchData();
            }
        }

        async function fetchData() {
            document.getElementById('status').innerText = "üì° Refreshing Fixtures (1 Credit)...";
            const leagues = ['soccer_epl', 'soccer_spain_la_liga', 'soccer_italy_serie_a', 'soccer_germany_bundesliga', 'soccer_uefa_champs_league'];
            let combined = [];

            for (const league of leagues) {
                try {
                    const res = await fetch(`https://api.the-odds-api.com/v4/sports/${league}/odds/?apiKey=${ODDS_KEY}&regions=uk&markets=h2h,totals,btts&oddsFormat=decimal`);
                    const data = await res.json();
                    if (data.length) combined = combined.concat(data);
                } catch (e) { console.warn("League skipped:", league); }
            }

            localStorage.setItem('scout_cache_v4', JSON.stringify({ ts: Date.now(), data: combined }));
            render(combined);
            document.getElementById('status').innerText = "Sync Complete";
        }

        async function scoutMatch(home, away, id) {
            const el = document.querySelector(`#card-${id} .ai-scout`);
            el.style.display = 'block';
            el.innerText = "ü™Ñ Gemini 3 Flash is searching 2026 injury reports...";

            try {
                const res = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${GEMINI_KEY}`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        contents: [{ parts: [{ text: `Search live Feb 2026 news for ${home} vs ${away}. List key injuries and give a 1-sentence betting verdict.` }] }],
                        tools: [{ google_search: {} }]
                    })
                });
                const json = await res.json();
                el.innerHTML = `<strong>AI REPORT:</strong><br>${json.candidates[0].content.parts[0].text}`;
            } catch (e) { el.innerText = "Live news unavailable. Odds suggest market stability."; }
        }

        function toggle(id, odd, home, away) {
            const card = document.getElementById(`card-${id}`);
            if (selections.has(id)) {
                selections.delete(id);
                card.classList.remove('selected');
                card.querySelector('.ai-scout').style.display = 'none';
            } else {
                selections.set(id, odd);
                card.classList.add('selected');
                scoutMatch(home, away, id);
            }
            calc();
        }

        function calc() {
            let total = 1;
            selections.forEach(v => total *= v);
            if (selections.size === 0) total = 0;

            document.getElementById('totalOdds').innerText = total.toFixed(2);
            const rawPayout = total * currentStake;
            
            if (rawPayout > EASYBET_LIMIT) {
                document.getElementById('payout').innerText = `R${EASYBET_LIMIT.toLocaleString()}`;
                document.getElementById('capWarning').innerText = "‚ö†Ô∏è MAXIMUM PAYOUT REACHED (R2,000,000 CAP)";
            } else {
                document.getElementById('payout').innerText = `R${rawPayout.toFixed(2)}`;
                document.getElementById('capWarning').innerText = "";
            }
        }

        function render(data) {
            document.getElementById('matches').innerHTML = data.map((m, i) => {
                const odds = m.bookmakers[0]?.markets[0]?.outcomes[0]?.price || 1.85;
                return `
                <div class="card" id="card-${i}" onclick="toggle(${i}, ${odds}, '${m.home_team}', '${m.away_team}')">
                    <div style="font-size: 0.7em; margin-bottom: 5px; opacity: 0.6;">${m.sport_title}</div>
                    <strong>${m.home_team} v ${m.away_team}</strong>
                    <div style="margin-top: 10px;">
                        <span class="market-badge">Win @${odds}</span>
                        <span class="market-badge">BTTS</span>
                    </div>
                    <div class="ai-scout"></div>
                </div>`;
            }).join('');
        }

        function toggleSettings() {
            const m = document.getElementById('settingsModal');
            const o = document.getElementById('overlay');
            const show = m.style.display !== 'block';
            m.style.display = show ? 'block' : 'none';
            o.style.display = show ? 'block' : 'none';
        }

        function applyTheme(val) {
            const theme = val || document.getElementById('themeSelect').value;
            document.body.className = theme;
            document.getElementById('themeSelect').value = theme;
            localStorage.setItem('scout_theme', theme);
        }

        function updateStake() {
            currentStake = document.getElementById('stakeInput').value;
            document.getElementById('displayStake').innerText = currentStake;
            localStorage.setItem('scout_stake', currentStake);
            calc();
        }

        init();
    </script>
</body>
</html>
